var log_sum_exp = function(bns){
  var lls = map(function(bn){
    return bn.ll
  }, bns)
  var m = reduce(function(x,acc){return x > acc ? x : acc}, -Infinity, lls);
  var summands = map(function(ll){Math.exp(ll-m)}, lls)
  return m + Math.log(Math.sum(summands))
}

var state_prior = cache(function() {
  var distr = Infer({method:'enumerate', model:function(){
    var bn = uniformDraw(globalStore.bns)
    var Table = bn.Table
    var cn = bn.cn
    var state = {"table": Table,
                 "cn": cn,
                 "bn_id": bn["bn_id"],
                 "table_id": bn["table_id"]
                };
    factor(bn.ll)
    return state
  }});
  return(distr)
})
